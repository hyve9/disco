<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
	<div class="header">
		<header>
			<img src="icons/soundwave.gif" alt="soundon"/>
			<!--img src="icons/soundwave.gif" alt="soundon" class="head2"/-->
		</header>
  </div>
	<div id="thedisco">
			<section class="thedisco">
				<button data-playing="false" class="osc-play" role="switch" aria-checked="false" onclick="vanish()">
					<span>clickme</span>
					<img src="icons/whoistheringer.png"/>
				</button>
				<p class="text-content">
					Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Risus in hendrerit gravida rutrum quisque non tellus orci. Pretium lectus quam id leo. Curabitur vitae nunc sed velit dignissim sodales. Aliquam ultrices sagittis orci a scelerisque purus semper. Quis eleifend quam adipiscing vitae proin sagittis nisl rhoncus. Dictum fusce ut placerat orci nulla. Viverra mauris in aliquam sem fringilla. A cras semper auctor neque vitae tempus quam pellentesque. Eget magna fermentum iaculis eu non diam phasellus vestibulum lorem. Sed arcu non odio euismod. Vivamus arcu felis bibendum ut tristique. A cras semper auctor neque vitae tempus. Tempor id eu nisl nunc mi. Tortor condimentum lacinia quis vel eros donec ac. Pretium vulputate sapien nec sagittis aliquam malesuada bibendum arcu vitae. Donec ac odio tempor orci dapibus. Ultrices neque ornare aenean euismod elementum nisi. Tincidunt lobortis feugiat vivamus at augue eget arcu. <br><br>

					Et netus et malesuada fames ac turpis egestas. Mauris cursus mattis molestie a. Platea dictumst vestibulum rhoncus est pellentesque elit ullamcorper dignissim cras. Vitae elementum curabitur vitae nunc sed. Condimentum id venenatis a condimentum vitae sapien. Neque ornare aenean euismod elementum nisi quis. Lacus viverra vitae congue eu consequat ac felis donec et. Morbi quis commodo odio aenean sed adipiscing. Morbi leo urna molestie at elementum eu facilisis. Ultricies mi quis hendrerit dolor magna eget. Malesuada fames ac turpis egestas. <br><br>

					Sed blandit libero volutpat sed cras ornare arcu. Semper viverra nam libero justo. Sit amet risus nullam eget felis eget nunc lobortis. Enim nec dui nunc mattis enim ut tellus elementum sagittis. Volutpat maecenas volutpat blandit aliquam etiam erat. Maecenas pharetra convallis posuere morbi leo urna molestie at. Volutpat odio facilisis mauris sit amet massa vitae tortor. Egestas congue quisque egestas diam in arcu cursus euismod. Risus nullam eget felis eget nunc. Libero nunc consequat interdum varius sit amet mattis vulputate enim. Dictumst quisque sagittis purus sit amet volutpat consequat. Placerat vestibulum lectus mauris ultrices eros. Nunc scelerisque viverra mauris in aliquam. Tincidunt vitae semper quis lectus nulla at volutpat. <br><br>

					Nunc sed velit dignissim sodales. Nec ullamcorper sit amet risus nullam eget felis. Tortor consequat id porta nibh venenatis cras sed. Mi bibendum neque egestas congue. Porta non pulvinar neque laoreet suspendisse interdum consectetur. Lobortis scelerisque fermentum dui faucibus in. Etiam dignissim diam quis enim lobortis scelerisque fermentum. Ullamcorper velit sed ullamcorper morbi tincidunt ornare. Pharetra sit amet aliquam id diam. Facilisis magna etiam tempor orci eu lobortis. Orci a scelerisque purus semper eget duis at tellus at. Mattis aliquam faucibus purus in. Vulputate dignissim suspendisse in est. <br><br>

					Pretium quam vulputate dignissim suspendisse. Ornare arcu odio ut sem nulla pharetra diam. Eu feugiat pretium nibh ipsum consequat nisl. Tellus cras adipiscing enim eu turpis egestas pretium aenean pharetra. Cras adipiscing enim eu turpis. Lectus quam id leo in vitae turpis massa sed. Elit sed vulputate mi sit amet mauris commodo quis imperdiet. Viverra aliquet eget sit amet. Aliquam malesuada bibendum arcu vitae elementum. Mi quis hendrerit dolor magna eget est. Dictumst vestibulum rhoncus est pellentesque elit ullamcorper. Elit pellentesque habitant morbi tristique. Enim neque volutpat ac tincidunt vitae. At elementum eu facilisis sed odio morbi quis commodo odio. In iaculis nunc sed augue lacus viverra. Dui accumsan sit amet nulla facilisi morbi tempus iaculis urna. <br><br>

					Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Risus in hendrerit gravida rutrum quisque non tellus orci. Pretium lectus quam id leo. Curabitur vitae nunc sed velit dignissim sodales. Aliquam ultrices sagittis orci a scelerisque purus semper. Quis eleifend quam adipiscing vitae proin sagittis nisl rhoncus. Dictum fusce ut placerat orci nulla. Viverra mauris in aliquam sem fringilla. A cras semper auctor neque vitae tempus quam pellentesque. Eget magna fermentum iaculis eu non diam phasellus vestibulum lorem. Sed arcu non odio euismod. Vivamus arcu felis bibendum ut tristique. A cras semper auctor neque vitae tempus. Tempor id eu nisl nunc mi. Tortor condimentum lacinia quis vel eros donec ac. Pretium vulputate sapien nec sagittis aliquam malesuada bibendum arcu vitae. Donec ac odio tempor orci dapibus. Ultrices neque ornare aenean euismod elementum nisi. Tincidunt lobortis feugiat vivamus at augue eget arcu. <br><br>

					Et netus et malesuada fames ac turpis egestas. Mauris cursus mattis molestie a. Platea dictumst vestibulum rhoncus est pellentesque elit ullamcorper dignissim cras. Vitae elementum curabitur vitae nunc sed. Condimentum id venenatis a condimentum vitae sapien. Neque ornare aenean euismod elementum nisi quis. Lacus viverra vitae congue eu consequat ac felis donec et. Morbi quis commodo odio aenean sed adipiscing. Morbi leo urna molestie at elementum eu facilisis. Ultricies mi quis hendrerit dolor magna eget. Malesuada fames ac turpis egestas. <br><br>

					Sed blandit libero volutpat sed cras ornare arcu. Semper viverra nam libero justo. Sit amet risus nullam eget felis eget nunc lobortis. Enim nec dui nunc mattis enim ut tellus elementum sagittis. Volutpat maecenas volutpat blandit aliquam etiam erat. Maecenas pharetra convallis posuere morbi leo urna molestie at. Volutpat odio facilisis mauris sit amet massa vitae tortor. Egestas congue quisque egestas diam in arcu cursus euismod. Risus nullam eget felis eget nunc. Libero nunc consequat interdum varius sit amet mattis vulputate enim. Dictumst quisque sagittis purus sit amet volutpat consequat. Placerat vestibulum lectus mauris ultrices eros. Nunc scelerisque viverra mauris in aliquam. Tincidunt vitae semper quis lectus nulla at volutpat. <br><br>

					Nunc sed velit dignissim sodales. Nec ullamcorper sit amet risus nullam eget felis. Tortor consequat id porta nibh venenatis cras sed. Mi bibendum neque egestas congue. Porta non pulvinar neque laoreet suspendisse interdum consectetur. Lobortis scelerisque fermentum dui faucibus in. Etiam dignissim diam quis enim lobortis scelerisque fermentum. Ullamcorper velit sed ullamcorper morbi tincidunt ornare. Pharetra sit amet aliquam id diam. Facilisis magna etiam tempor orci eu lobortis. Orci a scelerisque purus semper eget duis at tellus at. Mattis aliquam faucibus purus in. Vulputate dignissim suspendisse in est. <br><br>

					Pretium quam vulputate dignissim suspendisse. Ornare arcu odio ut sem nulla pharetra diam. Eu feugiat pretium nibh ipsum consequat nisl. Tellus cras adipiscing enim eu turpis egestas pretium aenean pharetra. Cras adipiscing enim eu turpis. Lectus quam id leo in vitae turpis massa sed. Elit sed vulputate mi sit amet mauris commodo quis imperdiet. Viverra aliquet eget sit amet. Aliquam malesuada bibendum arcu vitae elementum. Mi quis hendrerit dolor magna eget est. Dictumst vestibulum rhoncus est pellentesque elit ullamcorper. Elit pellentesque habitant morbi tristique. Enim neque volutpat ac tincidunt vitae. At elementum eu facilisis sed odio morbi quis commodo odio. In iaculis nunc sed augue lacus viverra. Dui accumsan sit amet nulla facilisi morbi tempus iaculis urna. <br><br>
				</p>
			</section>
	</div>

	<script type="text/javascript">
		console.clear();

		// instigate our audio context

		// for cross browser
		const AudioContext = window.AudioContext || window.webkitAudioContext;
		let audioCtx;

		const playButton = document.querySelector('.osc-play');
		const text = document.querySelector('.text-content');

		const header = document.querySelector('.header');
		const sticky = header.offsetTop;

		// button to disappear on click, text to appear on click
		var vanish = function() {
			setTimeout(function() {
				playButton.style.display="none";
				text.style.display="block";
			}, 1500);
		};

		function getDocHeight() {
	    var D = document;
	    return Math.max(
	        D.body.scrollHeight, D.documentElement.scrollHeight,
	        D.body.offsetHeight, D.documentElement.offsetHeight,
	        D.body.clientHeight, D.documentElement.clientHeight
	    );
		}

		var docheight = getDocHeight()

		function amountscrolled(){
			var winheight= window.innerHeight || (document.documentElement || document.body).clientHeight;
			var docheight = getDocHeight();
			var scrollTop = window.pageYOffset || (document.documentElement || document.body.parentNode || document.body).scrollTop;
			var trackLength = docheight - winheight;
			var pctScrolled = scrollTop/trackLength;
			return pctScrolled;
		}

		// set up some global vars
		let oscillator;
		let gainNode;

		// play pause audio
		playButton.addEventListener('click', function() {
		  if(!audioCtx) {
				audioCtx = new AudioContext();
			}

			// create Oscillator
			oscillator = audioCtx.createOscillator();

			//const waves = ['sine', 'triangle', 'sawtooth', 'square'];
			const waves = ['sine'];
			// C2, G2, E3, B3, G4, D5, F6
			const freqs = [65.41, 98.0, 164.81, 246.94, 392.0, 587.33, 1479.98];

			oscillator.type = waves[Math.floor(Math.random()*waves.length)];
			oscillator.frequency.value = freqs[Math.floor(Math.random()*freqs.length)]; // value in hertz


			// volume
			gainNode = audioCtx.createGain();
			gainNode.gain.value = 0;

			// connect our graph
			oscillator.connect(gainNode).connect(audioCtx.destination);

			// check if context is in suspended state (autoplay policy)
			if (audioCtx.state === 'suspended') {
				audioCtx.resume();
			}

			if (this.dataset.playing === 'false') {
				// start oscillator
				oscillator.start(audioCtx.currentTime);
				this.dataset.playing = 'true';
			}
			//if track is playing pause it
		  else if (this.dataset.playing === 'true') {
			  oscillator.stop(audioCtx.currentTime);
				this.dataset.playing = 'false';
			}

			let state = this.getAttribute('aria-checked') === "true" ? true : false;
			this.setAttribute( 'aria-checked', state ? "false" : "true" );

		}, false);

		window.addEventListener('scroll', function() {
			if(audioCtx) {
				gainNode.gain.setValueAtTime(amountscrolled(), audioCtx.currentTime);
				console.log(amountscrolled());
				console.log(gainNode.gain)
			}
			if (window.pageYOffset > sticky) {
    		header.classList.add("sticky");
  		} else {
	    	header.classList.remove("sticky");
  		}
		}, false);

	</script>

</body>
</html>
